<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="de"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>CashCorrectionAction.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Rails</a> &gt; <a href="index.source.html" class="el_package">rails.game.correct</a> &gt; <span class="el_source">CashCorrectionAction.java</span></div><h1>CashCorrectionAction.java</h1><pre class="source lang-java linenums">package rails.game.correct;


import java.io.IOException;
import java.io.ObjectInputStream;

import com.google.common.base.Objects;

import rails.game.action.PossibleAction;
import net.sf.rails.game.Player;
import net.sf.rails.game.PublicCompany;
import net.sf.rails.game.state.MoneyOwner;
import net.sf.rails.util.RailsObjects;
import net.sf.rails.util.Util;

/**
 * Correction action that changes the cash position of a MoneyOwner.
 * 
 * Rails 2.0: updated equals and toString methods
 */
public class CashCorrectionAction extends CorrectionAction {

    /** The Constant serialVersionUID. */
    public static final long serialVersionUID = 1L;
    
    /* Preconditions */
   
    /** cash holder */
    transient private MoneyOwner correctCashHolder; 

    /** converted to name */
    private String cashHolderName; 
    private String cashHolderType;

    /** maximum Amount to deduct */
    private int maximumNegative; 
        
    /* Postconditions */

    /** selected cash amount */
    private int correctAmount; 
    
   /**
    * Instantiates a new correct cash
    * 
    * @param pl Player
    */
<span class="fc" id="L48">   public CashCorrectionAction(Player pl) {</span>
<span class="fc" id="L49">       correctCashHolder = pl;</span>
<span class="fc" id="L50">       cashHolderName = pl.getId();</span>
<span class="fc" id="L51">       cashHolderType = &quot;Player&quot;;</span>
<span class="fc" id="L52">       maximumNegative = pl.getCashValue();</span>
<span class="fc" id="L53">       setCorrectionType(CorrectionType.CORRECT_CASH);</span>
<span class="fc" id="L54">   }</span>
   /**
    * Instantiates a new correct cash
    * 
    * @param pc Public Company
    */
<span class="fc" id="L60">   public CashCorrectionAction(PublicCompany pc) {</span>
<span class="fc" id="L61">       correctCashHolder = pc;</span>
<span class="fc" id="L62">       cashHolderName = pc.getId();</span>
<span class="fc" id="L63">       cashHolderType = &quot;PublicCompany&quot;;</span>
<span class="fc" id="L64">       maximumNegative = pc.getCash();</span>
<span class="fc" id="L65">       setCorrectionType(CorrectionType.CORRECT_CASH);</span>
<span class="fc" id="L66">   }</span>
   
   
   public MoneyOwner getCashHolder() {
<span class="fc" id="L70">       return correctCashHolder;</span>
   }

   public String getCashHolderName() {
<span class="nc" id="L74">       return cashHolderName;</span>
   }

   public int getMaximumNegative(){
<span class="nc" id="L78">       return maximumNegative;</span>
   }

   public int getAmount() {
<span class="fc" id="L82">       return correctAmount;</span>
   }

   public void setAmount(int amount) {
<span class="nc" id="L86">       correctAmount = amount;</span>
<span class="nc" id="L87">   }</span>
    
   @Override
   protected boolean equalsAs(PossibleAction pa, boolean asOption) {
       // identity always true
<span class="nc bnc" id="L92" title="All 2 branches missed.">       if (pa == this) return true;</span>
       //  super checks both class identity and super class attributes
<span class="nc bnc" id="L94" title="All 2 branches missed.">       if (!super.equalsAs(pa, asOption)) return false; </span>

       // check asOption attributes
<span class="nc" id="L97">        CashCorrectionAction action = (CashCorrectionAction)pa;</span>
<span class="nc bnc" id="L98" title="All 2 branches missed.">        boolean options =  Objects.equal(this.correctCashHolder, action.correctCashHolder)</span>
<span class="nc bnc" id="L99" title="All 2 branches missed.">                &amp;&amp; Objects.equal(this.maximumNegative, action.maximumNegative)</span>
        ;
        
        // finish if asOptions check
<span class="nc bnc" id="L103" title="All 2 branches missed.">        if (asOption) return options;</span>
        
<span class="nc bnc" id="L105" title="All 2 branches missed.">        return options</span>
<span class="nc bnc" id="L106" title="All 2 branches missed.">                &amp;&amp; Objects.equal(this.correctAmount, action.correctAmount)</span>
        ;
    }
    
    @Override
    public String toString() {
<span class="fc" id="L112">        return super.toString() + </span>
<span class="fc" id="L113">                RailsObjects.stringHelper(this)</span>
<span class="fc" id="L114">                    .addToString(&quot;correctCashHolder&quot;, correctCashHolder)</span>
<span class="fc" id="L115">                    .addToString(&quot;maximumNegative&quot;, maximumNegative)</span>
<span class="fc" id="L116">                    .addToStringOnlyActed(&quot;correctAmount&quot;, correctAmount)</span>
<span class="fc" id="L117">                .toString()</span>
        ;
    }

    /** Deserialize */
    private void readObject(ObjectInputStream in) throws IOException,
            ClassNotFoundException {
<span class="fc" id="L124">        in.defaultReadObject();</span>
        
<span class="pc bpc" id="L126" title="1 of 2 branches missed.">        if (Util.hasValue(correctionName))</span>
<span class="fc" id="L127">            correctionType = CorrectionType.valueOf(correctionName);</span>

<span class="pc bpc" id="L129" title="2 of 4 branches missed.">        if (Util.hasValue(cashHolderType) &amp;&amp; Util.hasValue(cashHolderName)) {</span>
<span class="fc bfc" id="L130" title="All 2 branches covered.">            if (cashHolderType.equals(&quot;Player&quot;))</span>
<span class="fc" id="L131">                correctCashHolder = getGameManager().getRoot().getPlayerManager().getPlayerByName(cashHolderName);</span>
<span class="pc bpc" id="L132" title="1 of 2 branches missed.">            else if (cashHolderType.equals(&quot;PublicCompany&quot;))</span>
<span class="fc" id="L133">                correctCashHolder = getCompanyManager().getPublicCompany(cashHolderName);</span>
        }
<span class="fc" id="L135">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.5.201910111838</span></div></body></html>