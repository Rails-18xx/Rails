<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="de"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>SoundConfig.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Rails</a> &gt; <a href="index.source.html" class="el_package">net.sf.rails.sound</a> &gt; <span class="el_source">SoundConfig.java</span></div><h1>SoundConfig.java</h1><pre class="source lang-java linenums">package net.sf.rails.sound;

import java.util.Arrays;
import java.util.HashSet;
import java.util.Set;

import net.sf.rails.common.Config;


/**
 * A wrapper to the standard config providing additional services for
 * - contextual config elements (e.g., phase-dependent OR music)
 * - default config elements (e.g., default OR music)
 *
 * In addition, config keys are available as constants.
 *
 * @author Frederick Weld
 *
 */
<span class="nc" id="L20">public class SoundConfig {</span>
    public static final String KEY_BGM_ENABLED = &quot;sound.backgroundMusic&quot;;
    public static final String KEY_BGM_GAME_SETUP = &quot;sound.backgroundMusic.gameSetup&quot;;
    public static final String KEY_BGM_START_ROUND = &quot;sound.backgroundMusic.startRound&quot;;
    public static final String KEY_BGM_STOCK_ROUND = &quot;sound.backgroundMusic.stockRound&quot;;
    public static final String KEY_BGM_OPERATING_ROUND = &quot;sound.backgroundMusic.operatingRound&quot;;
    public static final String KEY_BGM_END_OF_GAME_ROUND = &quot;sound.backgroundMusic.endOfGameRound&quot;;
    public static final String KEY_SFX_ENABLED = &quot;sound.sfx&quot;;
    public static final String KEY_SFX_GEN_GAME_OVER_PENDING = &quot;sound.sfx.gen.gameOverPending&quot;;
    public static final String KEY_SFX_GEN_PASS = &quot;sound.sfx.gen.pass&quot;;
    public static final String KEY_SFX_GEN_SELECT = &quot;sound.sfx.gen.select&quot;;
    public static final String KEY_SFX_GEN_NEW_CURRENT_PLAYER = &quot;sound.sfx.gen.newCurrentPlayer&quot;;
    public static final String KEY_SFX_STR_BID_START_ITEM = &quot;sound.sfx.str.bidStartItem&quot;;
    public static final String KEY_SFX_STR_BUY_START_ITEM = &quot;sound.sfx.str.buyStartItem&quot;;
    public static final String KEY_SFX_SR_OPENING_BELL = &quot;sound.sfx.sr.openingBell&quot;;
    public static final String KEY_SFX_SR_NEW_PRESIDENT = &quot;sound.sfx.sr.newPresident&quot;;
    public static final String KEY_SFX_SR_BUY_SHARE_PRESIDENT = &quot;sound.sfx.sr.buyShare.president&quot;;
    public static final String KEY_SFX_SR_BUY_SHARE_NON_PRESIDENT = &quot;sound.sfx.sr.buyShare.nonPresident&quot;;
    public static final String KEY_SFX_SR_SELL_SHARE_PRESIDENT = &quot;sound.sfx.sr.sellShare.president&quot;;
    public static final String KEY_SFX_SR_SELL_SHARE_NON_PRESIDENT = &quot;sound.sfx.sr.sellShare.nonPresident&quot;;
    public static final String KEY_SFX_SR_COMPANY_FLOATS = &quot;sound.sfx.sr.companyFloats&quot;;
    public static final String KEY_SFX_OR_ROTATE_TILE = &quot;sound.sfx.or.rotateTile&quot;;
    public static final String KEY_SFX_OR_LAY_TILE_TRACK = &quot;sound.sfx.or.layTile.track&quot;;
    public static final String KEY_SFX_OR_LAY_TILE_CITY = &quot;sound.sfx.or.layTile.city&quot;;
    public static final String KEY_SFX_OR_LAY_TILE_LAST_TILE_LAID = &quot;sound.sfx.or.layTile.lastTileLaid&quot;;
    public static final String KEY_SFX_OR_LAY_TOKEN = &quot;sound.sfx.or.layToken&quot;;
    public static final String KEY_SFX_OR_SET_REVENUE = &quot;sound.sfx.or.setRevenue&quot;;
    public static final String KEY_SFX_OR_DECISION_PAYOUT = &quot;sound.sfx.or.decision.payout&quot;;
    public static final String KEY_SFX_OR_DECISION_SPLIT = &quot;sound.sfx.or.decision.split&quot;;
    public static final String KEY_SFX_OR_DECISION_WITHHOLD = &quot;sound.sfx.or.decision.withhold&quot;;
    public static final String KEY_SFX_OR_BUY_TRAIN = &quot;sound.sfx.or.buyTrain&quot;;
    public static final String KEY_SFX_OR_BUY_PRIVATE = &quot;sound.sfx.or.buyPrivate&quot;;

    /**
     * list of sfx which are to be played immediately (without waiting for completion of
     * prior sfx threads)
     */
<span class="nc" id="L57">    protected static final Set&lt;String&gt; KEYS_SFX_IMMEDIATE_PLAYING = new HashSet&lt;String&gt;</span>
<span class="nc" id="L58">        (Arrays.asList(KEY_SFX_GEN_PASS,</span>
                KEY_SFX_GEN_SELECT,
                KEY_SFX_OR_ROTATE_TILE));

    //if set to true, sfx is reported not to be enabled irrespective of the configuration
<span class="nc" id="L63">    private static boolean isSFXDisabled = false;</span>

    public static String get(String configKey) {
<span class="nc" id="L66">        return get(configKey,null);</span>
    }
    public static String get(String configKey, String parameter) {
<span class="nc" id="L69">        String value = Config.get(configKey,&quot;&quot;);</span>
<span class="nc bnc" id="L70" title="All 2 branches missed.">        if (parameter == null) return value;</span>

        //processing parameterized config elements
<span class="nc" id="L73">        String resultValue = null;</span>
<span class="nc" id="L74">        String[] assignments = value.split(&quot;,&quot;);</span>
<span class="nc bnc" id="L75" title="All 2 branches missed.">        for ( String s : assignments ) {</span>
<span class="nc" id="L76">            String[] assignment = s.split(&quot;=&quot;);</span>
<span class="nc bnc" id="L77" title="All 2 branches missed.">            if ( assignment.length == 1 ) {</span>
                //default assignment (meaning, parameter-independent)
                //only to be considered if no value has been found yet
<span class="nc bnc" id="L80" title="All 2 branches missed.">                if ( resultValue == null ) resultValue = assignment[0];</span>
            }
<span class="nc bnc" id="L82" title="All 2 branches missed.">            else if ( assignment.length == 2 ) {</span>
                //parameterized assignment
                //only to be considered if parameter is as specified
<span class="nc bnc" id="L85" title="All 2 branches missed.">                if ( parameter.equals(assignment[0]) ) resultValue = assignment[1];</span>
            }
        }
<span class="nc bnc" id="L88" title="All 2 branches missed.">        if (resultValue == null) resultValue = &quot;&quot;;</span>
<span class="nc" id="L89">        return resultValue;</span>
    }
    public static boolean isBGMEnabled() {
<span class="nc" id="L92">        return isEnabled(KEY_BGM_ENABLED);</span>
    }
    public static boolean isSFXEnabled() {
<span class="nc bnc" id="L95" title="All 4 branches missed.">        return isEnabled(KEY_SFX_ENABLED) &amp;&amp; !isSFXDisabled;</span>
    }
    private static boolean isEnabled(String key) {
<span class="nc" id="L98">        return &quot;enabled&quot;.equals(get(key));</span>
    }
    public static void setSFXDisabled(boolean timeWarpMode) {
<span class="nc" id="L101">        isSFXDisabled = timeWarpMode;</span>
<span class="nc" id="L102">    }</span>
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.5.201910111838</span></div></body></html>